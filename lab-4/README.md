Задание 4 linux

---

48pcs 22.44% 1,1Mb 80-2 22-0 443-0 54C 447.14Gb 34.6Gb \n

---
# Ответы по пунктам

1.1.1 48 процессов (шт), ps -u выбрать процессы пользователя, wc -l вывести количество строк в файле 

`ps -u | wc -l`

1.1.2. Загрузка CPU в % 22.44

`grep 'cpu ' /proc/stat | awk '{usage=($2+$4)*100/($2+$4+$5)} END {print usage "%"}'`

команда grep поиск cpu, 
/proc/stat - статистика по ядрам процессора, 
с помощью утилиты awk объявляем переменную внутри которой считаем среднее значение в % нагрузки на cpu,
print usage "%" вывод начение в терминал

1.1.3. Объем доступной оперативной памяти (в байтах или МБ) 1,1 Мб команда 

`free -h`

1.1.4. Количество установленных соединений по произвольному порту (например, 80- 2шт, 22-0шт, 443-0шт) на вашем компьютере (т.е. «кто подключился к вам»). Порт задается параметром запуска.

`netstat -ant | awk '{print $4}' | grep ":80$" -c`

`netstat -ntlp | grep LISTEN` узнать ip и порты 

1.1.5. Температура на сенсорах (CPU, MB) 54C k10temp температура датчика процессора

`watch -n 2 sensors` или `sensors`

1.1.6. Общий суммарный объем всех дисковых устройств, установленных в текущий момент на компьютере (байты, КБ или Гб). 447.14Гб, установить lsblk

`df -h`
 
1.1.7. Общий суммарный объем всех устройств, смонтированных в текущий момент в системе (байты, КБ или Гб). 34.6 Гб 

`cfdisk`

1.1.8. Размер всех баз в MySQL, к которым у текущего пользователя есть доступ.
`sudo mysql -V`узнать версию базы данных 
`sudo mysql -u root -p` чтобы подключиться к серверу базы данных MySQL
`mysql> show databases;` перечисляет все MySQL БД
`grep -r datadir /etc/mysql/` позволяет узнать где на компютеле в linux находиться БД

Для того что бы узнать размер всех баз данных в MySQL одим команду приведенную ниже, предварительно подключившись к БД.
`mysql> SELECT table_schema "database_name", sum( data_length + index_length )/1024/1024 "Data Base Size in MB" FROM information_schema.TABLES GROUP BY table_schema;`
так будет выглядеть вывод информации в консоли.

![alt text](https://github.com/andy-ml/dev_ops/blob/main/lab-4/BD1.png)

Что бы узнать размер таблиц определенной базы данных, где `"mysql"` название БД
```
mysql> SELECT table_name AS `Table`, round(((data_length + index_length) / 1024 / 1024), 2) `Size in MB` FROM information_schema.TABLES WHERE table_schema = "mysql";
```
Выйти из БД `mysql> exit`
    
1.2.1 Написать скрипт, который рандомно сгенерирует на диске структуру файлов и папок.        
Справка.        
Для написания скрипта для bash создаем файл  c кой первой строкой #!/bin/bash, затем пишем свой скрипт, что бы сделать файл исполняемым выполняем команду `chmod ugo+x файл_скрипта`
`dd` - это команда копирования, аналог утилиты `cp` только для блочных данных. `dd` просто переносит по одному блоку данных указанного в параметрах размера с одного места на другое.
Общий синтаксис команды таков:
`$ dd if=источник_копирования of=место_назначения параметры параметры`
`bs=1` указываем сколько байт читать и записывать за один раз 
`count=${MAX_FILE_SIZE}` внешний параметр, скопировать указанное количество блоков размер блока задали параметром `bs=1`    
![alt text](https://github.com/andy-ml/dev_ops/blob/main/lab-4/script-1.2.1.jpg)    
---
Я попытался написать скрипт из задания 1.2.2 но он не работает    
1.2.2. Написать скрипт, который принимает 2 входных параметра: source_dir и destination_dir - две директории на диске, сравнивает, что они ни одна из них не является родительской для другой, у них не совпадают имена и т.п. Далее скрипт должен подсчитать место, занимаемое source_dir, и место, доступное на диске, где находится директория destination_dir, если есть доступное место - скопировать (с наследованием всех атрибутов: времени создания, доступа и модификации, владельца и т.п.), если места нет - вывести предупреждение на экран и предложить пользователю продолжить (C или Y) или прервать (N или A).
